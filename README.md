# ğŸš€ MultiAgentPPT

ä¸€ä¸ªåŸºäº A2A + MCP + ADK çš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼Œæ”¯æŒæµå¼å¹¶å‘ç”Ÿæˆé«˜è´¨é‡ (å¯åœ¨çº¿ç¼–è¾‘ï¼‰PPT å†…å®¹ã€‚

## ğŸ§  ä¸€ã€é¡¹ç›®ç®€ä»‹

MultiAgentPPT åˆ©ç”¨å¤šæ™ºèƒ½ä½“æ¶æ„å®ç°ä»ä¸»é¢˜è¾“å…¥åˆ°å®Œæ•´æ¼”ç¤ºæ–‡ç¨¿ç”Ÿæˆçš„è‡ªåŠ¨åŒ–æµç¨‹ï¼Œä¸»è¦æ­¥éª¤åŒ…æ‹¬ï¼š

1. **å¤§çº²ç”Ÿæˆ Agent**ï¼šæ ¹æ®ç”¨æˆ·éœ€æ±‚ç”Ÿæˆåˆæ­¥å†…å®¹å¤§çº²ã€‚
2. **Topic æ‹†åˆ† Agent**ï¼šå°†å¤§çº²å†…å®¹ç»†åˆ†ä¸ºå¤šä¸ªä¸»é¢˜ã€‚
3. **Research Agent å¹¶è¡Œå·¥ä½œ**ï¼šå¤šä¸ªæ™ºèƒ½ä½“åˆ†åˆ«å¯¹æ¯ä¸ªä¸»é¢˜è¿›è¡Œæ·±å…¥è°ƒç ”ã€‚
4. **Summary Agent æ±‡æ€»è¾“å‡º**ï¼šå°†è°ƒç ”ç»“æœæ±‡æ€»ç”Ÿæˆ PPT å†…å®¹ï¼Œå®æ—¶æµå¼è¿”å›å‰ç«¯ã€‚

## ä¼˜ç‚¹
- **å¤šAgentåä½œ**ï¼šé€šè¿‡å¤šæ™ºèƒ½ä½“å¹¶è¡Œå·¥ä½œï¼Œæé«˜å†…å®¹ç”Ÿæˆçš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚
- **å®æ—¶æµå¼è¿”å›**ï¼šæ”¯æŒæµå¼è¿”å›ç”Ÿæˆçš„ PPT å†…å®¹ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚
- **é«˜è´¨é‡å†…å®¹**ï¼šç»“åˆå¤–éƒ¨æ£€ç´¢å’Œæ™ºèƒ½ä½“åä½œï¼Œç”Ÿæˆé«˜è´¨é‡çš„å†…å®¹å¤§çº²å’Œæ¼”ç¤ºæ–‡ç¨¿ã€‚
- **å¯æ‰©å±•æ€§**ï¼šç³»ç»Ÿè®¾è®¡çµæ´»ï¼Œæ˜“äºæ‰©å±•æ–°çš„æ™ºèƒ½ä½“å’ŒåŠŸèƒ½æ¨¡å—ã€‚

## äºŒã€è¿‘æœŸå‡çº§
### âœ… å·²å®Œæˆï¼ˆDoneï¼‰
- âœ… é™¤ Gemini ä»¥å¤–æµçš„è¾“å‡º Bug ä¿®å¤ï¼ŒADK å’Œ A2A çš„åŒ…é—®é¢˜ï¼š[æŸ¥çœ‹è¯¦æƒ…](https://github.com/johnson7788/MultiAgentPPT/blob/stream/backend/birthday_planner/README.md)
- âœ… å›¾ç‰‡æ¸²æŸ“æ–¹é¢ï¼šæ ¹æ®æ˜¯å¦ä¸ºèƒŒæ™¯å›¾åŠ¨æ€åˆ‡æ¢æ ·å¼ï¼ˆ`object-cover` æˆ– `object-contain`ï¼‰ï¼Œå¹¶åœ¨éèƒŒæ™¯å›¾ä¸‹å±•ç¤ºè¯´æ˜æ–‡å­—ã€‚ä¸ºä¿è¯ PPT é¡µé¢å”¯ä¸€æ€§ï¼Œä½¿ç”¨å¤§æ¨¡å‹è¾“å‡ºä¸­çš„ `page_number` ä½œä¸ºå”¯ä¸€æ ‡è¯†ï¼Œæ›¿ä»£åŸå…ˆåŸºäºæ ‡é¢˜çš„æ–¹å¼ï¼Œä»¥æ”¯æŒå†…å®¹æ›´æ–°ä¸æ ¡å¯¹ã€‚
- âœ… ä½¿ç”¨å¾ªç¯ Agent ç”Ÿæˆæ¯ä¸€é¡µ PPTï¼Œä»£æ›¿ä¸€æ¬¡æ€§ç”Ÿæˆå…¨éƒ¨å†…å®¹ï¼Œæ–¹ä¾¿ç”Ÿæˆæ›´å¤šé¡µæ•°ï¼Œé¿å… LLM çš„ token è¾“å‡ºé™åˆ¶ã€‚
- âœ… å¼•å…¥ PPTChecker Agent æ£€æŸ¥æ¯ä¸€é¡µç”Ÿæˆçš„ PPT è´¨é‡ã€‚å®é™…æµ‹è¯•æ•ˆæœè‰¯å¥½ï¼Œè¯·è‡ªè¡Œæ›¿æ¢ä¸ºçœŸå®å›¾ç‰‡æ•°æ®å’Œå†…å®¹ RAG æ•°æ®ã€‚
- âœ… å‰ç«¯æ˜¾ç¤ºæ¯ä¸ª Agent çš„ç”Ÿæˆè¿‡ç¨‹çŠ¶æ€ã€‚
- âœ… pptxä¸‹è½½ï¼Œä½¿ç”¨python-pptxä¸‹è½½å‰ç«¯jsonæ•°æ®ï¼Œåç«¯æ¸²æŸ“ã€‚

### ğŸ“ å¾…å®Œæˆï¼ˆTodoï¼‰
- ğŸ”„ å¤šæ¨¡æ€ç†è§£å›¾ç‰‡ï¼šåŒ…æ‹¬å›¾ç‰‡æ–¹å‘ã€å¤§å°ç­‰æ ¼å¼å¤„ç†ï¼Œç”¨äºé€‚é… PPT ä¸åŒä½ç½®ã€‚
- ğŸ”„ metadata æ•°æ®ä¼ è¾“ï¼šæ”¯æŒå‰ç«¯å‘ Agent ä¼ è¾“é…ç½®ï¼ŒAgent è¿”å›ç»“æœæ—¶é™„å¸¦ metadata ä¿¡æ¯ã€‚

## ä¸‰ã€ä½¿ç”¨ç•Œé¢æˆªå›¾å±•ç¤º

ä»¥ä¸‹æ˜¯ MultiAgentPPT é¡¹ç›®çš„æ ¸å¿ƒåŠŸèƒ½æ¼”ç¤ºï¼š

### 1. è¾“å…¥ä¸»é¢˜ç•Œé¢

ç”¨æˆ·åœ¨ç•Œé¢ä¸­è¾“å…¥å¸Œæœ›ç”Ÿæˆçš„ PPT ä¸»é¢˜å†…å®¹ï¼š

![è¾“å…¥ä¸»é¢˜ç•Œé¢](docs/1æµ‹è¯•ç•Œé¢è¾“å…¥ä¸»é¢˜.png)

### 2. æµå¼ç”Ÿæˆå¤§çº²è¿‡ç¨‹

ç³»ç»Ÿæ ¹æ®è¾“å…¥å†…å®¹ï¼Œå®æ—¶æµå¼è¿”å›ç”Ÿæˆçš„å¤§çº²ç»“æ„ï¼š

![æµå¼ç”Ÿæˆå¤§çº²](docs/2æµå¼ç”Ÿæˆå¤§çº².png)

### 3. ç”Ÿæˆå®Œæ•´å¤§çº²

æœ€ç»ˆç³»ç»Ÿå°†å±•ç¤ºå®Œæ•´çš„å¤§çº²ï¼Œä¾›ç”¨æˆ·è¿›ä¸€æ­¥ç¡®è®¤ï¼š

![å®Œæ•´å¤§çº²](docs/3å®Œæ•´å¤§çº².png)

### 4. æµå¼ç”ŸæˆPPTå†…å®¹

ç¡®è®¤å¤§çº²åï¼Œç³»ç»Ÿå¼€å§‹æµå¼ç”Ÿæˆæ¯é¡µå¹»ç¯ç‰‡å†…å®¹ï¼Œå¹¶è¿”å›ç»™å‰ç«¯ï¼š

![æµå¼ç”ŸæˆPPT](docs/4æµå¼ç”ŸæˆPPT.png)

### 5. å¯¹äºå¤šAgentç”ŸæˆPPTï¼Œslide_agentä¸­ï¼Œæ·»åŠ è¿›åº¦ç»†èŠ‚å±•ç¤º
![process_detail1.png](docs/process_detail1.png)
![process_detail2.png](docs/process_detail2.png)
![process_detail3.png](docs/process_detail3.png)
![process_detail4.png](docs/process_detail4.png)
![image_update.png](docs/image_update.png)

## ğŸ“Š å¹¶å‘çš„å¤šAgentçš„åä½œæµç¨‹ï¼ˆslide_agent + slide_outline)
```mermaid
flowchart TD
    A[ç”¨æˆ·è¾“å…¥ç ”ç©¶å†…å®¹] --> B[è°ƒç”¨ Outline Agent]
    B --> C[MCP æ£€ç´¢èµ„æ–™]
    C --> D[ç”Ÿæˆå¤§çº²]
    D --> E{ç”¨æˆ·ç¡®è®¤å¤§çº²}
    E --> F[å‘é€å¤§çº²ç»™ PPT ç”Ÿæˆ Agent]

    F --> G[Split Outline Agent æ‹†åˆ†å¤§çº²]
    G --> H[Parallel Agent å¹¶è¡Œå¤„ç†]

    %% å¹¶å‘ Research Agent
    H --> I1[Research Agent 1]
    H --> I2[Research Agent 2]
    H --> I3[Research Agent 3]

    I1 --> RAG1[è‡ªåŠ¨çŸ¥è¯†åº“æ£€ç´¢ RAG]
    I2 --> RAG2[è‡ªåŠ¨çŸ¥è¯†åº“æ£€ç´¢ RAG]
    I3 --> RAG3[è‡ªåŠ¨çŸ¥è¯†åº“æ£€ç´¢ RAG]

    RAG1 --> J
    RAG2 --> J
    RAG3 --> J

    J --> L[Loop PPT Agent ç”Ÿæˆå¹»ç¯ç‰‡é¡µ]

    subgraph Loop PPT Agent
        L1[Write PPT Agent<br>ç”Ÿæˆæ¯é¡µå¹»ç¯ç‰‡]
        L2[Check PPT Agent<br>æ£€æŸ¥æ¯é¡µå†…å®¹è´¨é‡ï¼Œæœ€å¤šé‡è¯• 3 æ¬¡]
        L1 --> L2
        L2 --> L1
    end

    L --> L1
```


## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„

```bash
MultiAgentPPT/
â”œâ”€â”€ backend/              # åç«¯å¤šAgentæœåŠ¡ç›®å½•
â”‚   â”œâ”€â”€ simpleOutline/    # ç®€åŒ–ç‰ˆå¤§çº²ç”ŸæˆæœåŠ¡ï¼ˆæ— å¤–éƒ¨ä¾èµ–ï¼‰
â”‚   â”œâ”€â”€ simplePPT/        # ç®€åŒ–ç‰ˆPPTç”ŸæˆæœåŠ¡ï¼ˆä¸ä½¿ç”¨æ£€ç´¢æˆ–å¹¶å‘ï¼‰
â”‚   â”œâ”€â”€ slide_outline/    # å¸¦å¤–éƒ¨æ£€ç´¢çš„å¤§çº²ç”Ÿæˆå¤§çº²æœåŠ¡ï¼ˆå¤§çº²æ ¹æ®MCPå·¥å…·æ£€ç´¢åæ›´ç²¾å‡†ï¼‰
â”‚   â”œâ”€â”€ slide_agent/      # å¹¶å‘å¼å¤šAgent PPTç”Ÿæˆä¸»è¦xmlæ ¼å¼çš„PPTå†…å®¹
â”œâ”€â”€ frontend/             # Next.js å‰ç«¯ç•Œé¢
```

---

## âš™ï¸ å››ã€å¿«é€Ÿå¼€å§‹

### ğŸ 4.1 åç«¯ç¯å¢ƒé…ç½®ï¼ˆPythonï¼‰

1. åˆ›å»ºå¹¶æ¿€æ´» Conda è™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èpython3.11ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¦åˆ™å¯èƒ½æœ‰bugï¼‰ï¼š

   ```bash
   conda create --name multiagent python=3.12
   conda activate multiagent
   ```

2. å®‰è£…ä¾èµ–ï¼š

   ```bash
   cd backend
   pip install -r requirements.txt
   ```

3. è®¾ç½®åç«¯ç¯å¢ƒå˜é‡ï¼š

   ```bash
   # ä¸ºæ‰€æœ‰æ¨¡å—å¤åˆ¶æ¨¡æ¿é…ç½®æ–‡ä»¶
   cd backend/simpleOutline && cp env_template .env
   cd ../simplePPT && cp env_template .env
   cd ../slide_outline && cp env_template .env
   cd ../slide_agent && cp env_template .env
   ```

---

### ğŸ§ª 4.2 å¯åŠ¨åç«¯æœåŠ¡

| æ¨¡å—              | åŠŸèƒ½              | é»˜è®¤ç«¯å£                       | å¯åŠ¨å‘½ä»¤                 |
| --------------- | --------------- | -------------------------- | -------------------- |
| `simpleOutline` | ç®€å•å¤§çº²ç”Ÿæˆ          | 10001                      | `python main_api.py` |
| `simplePPT`     | ç®€å•PPTç”Ÿæˆ         | 10011                      | `python main_api.py` |
| `slide_outline` | é«˜è´¨é‡å¤§çº²ç”Ÿæˆï¼ˆå¸¦æ£€ç´¢ï¼‰    | 10001ï¼ˆéœ€å…³é—­ `simpleOutline`ï¼‰ | `python main_api.py` |
| `slide_agent`   | å¤šAgentå¹¶å‘ç”Ÿæˆå®Œæ•´PPT | 10011ï¼ˆéœ€å…³é—­ `simplePPT`ï¼‰     | `python main_api.py` |

---

## ğŸ§± äº”ã€å‰ç«¯æ•°æ®åº“è®¾ç½®å’Œå®‰è£…ä¸è¿è¡Œï¼ˆNext.jsï¼‰

æ•°æ®åº“å­˜å‚¨ç”¨æˆ·ç”Ÿæˆçš„PPTï¼š


1. ä½¿ç”¨ Docker å¯åŠ¨ PostgreSQLï¼š

   ```bash
   ä½¿ç”¨VPNæ—¶ä½¿ç”¨
   docker run --name postgresdb -p 5432:5432 -e POSTGRES_USER=postgres -e POSTGRES_PASSWORD=welcome -d postgres
   å›½å†…ä½¿ç”¨ï¼š
   docker run --name postgresdb -p 5432:5432 -e POSTGRES_USER=postgres -e POSTGRES_PASSWORD=welcome -d swr.cn-north-4.myhuaweicloud.com/ddn-k8s/quay.io/sclorg/postgresql-15-c9s:latest
   ```
   

2. ä¿®æ”¹`.env` ç¤ºä¾‹é…ç½®ï¼š

   ```env
   DATABASE_URL="postgresql://postgres:welcome@localhost:5432/presentation_ai"
   A2A_AGENT_OUTLINE_URL="http://localhost:10001"
   A2A_AGENT_SLIDES_URL="http://localhost:10011"
   ```

3. å®‰è£…ä¾èµ–å¹¶æ¨é€æ•°æ®åº“æ¨¡å‹ï¼š

   ```bash
   # å®‰è£…å‰ç«¯ä¾èµ–
   pnpm install
   # æ¨é€æ•°æ®åº“æ¨¡å‹å’Œæ’å…¥ç”¨æˆ·æ•°æ®
   pnpm db:push
   # å¯åŠ¨å‰ç«¯
   npm run dev
   ```

4. æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š[http://localhost:3000/presentation](http://localhost:3000/presentation)

---


---

## ğŸ§ª ç¤ºä¾‹æ•°æ®è¯´æ˜

> å½“å‰ç³»ç»Ÿå†…ç½®è°ƒç ”ç¤ºä¾‹ä¸ºï¼š**â€œç”µåŠ¨æ±½è½¦å‘å±•æ¦‚è¿°â€**ã€‚å¦‚éœ€å…¶ä»–ä¸»é¢˜è°ƒç ”ï¼Œè¯·é…ç½®å¯¹åº” Agent å¹¶å¯¹æ¥çœŸå®æ•°æ®æºã€‚
> é…ç½®çœŸå®æ•°æ®ï¼Œåªéœ€æ›´æ”¹promptå’Œå¯¹åº”çš„MCPå·¥å…·å³å¯ã€‚
---


## ğŸ“ å…­ã€å‚è€ƒæ¥æº

å‰ç«¯é¡¹ç›®éƒ¨åˆ†åŸºäºå¼€æºä»“åº“ï¼š[allweonedev/presentation-ai](https://github.com/allweonedev/presentation-ai)

## æ·»åŠ ä½œè€…å¾®ä¿¡ç­”ç–‘è§£æƒ‘
johnsongzc
